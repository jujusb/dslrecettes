/*
 * generated by Xtext 2.23.0
 */
package cuisine.recipe.ui.contentassist;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.HashSet;
import java.util.List;
import java.util.Set;
import java.util.stream.IntStream;

import org.eclipse.emf.ecore.EObject;
import org.eclipse.xtext.Assignment;
import org.eclipse.xtext.EcoreUtil2;
import org.eclipse.xtext.RuleCall;
import org.eclipse.xtext.ui.editor.contentassist.ContentAssistContext;
import org.eclipse.xtext.ui.editor.contentassist.ICompletionProposalAcceptor;

import cuisine.recipe.recipe.*;
import cuisine.recipe.validation.RecipeValidator;

/**
 * See https://www.eclipse.org/Xtext/documentation/310_eclipse_support.html#content-assist
 * on how to customize the content assistant.
 */
public class RecipeProposalProvider extends AbstractRecipeProposalProvider {
	List<String> paramsTechniques = new ArrayList<>();
	List<String> paramsQuantificateur = new ArrayList<>();
	List<String> preparationsCurrentRecipe= new ArrayList<>();
	boolean canCompleteInt=false;
	public RecipeProposalProvider() {	
		Collections.addAll(paramsQuantificateur,"kg" , "hg" , "dag" , "g" , "dg" , "cg" , "mg" , "kl" , "hl" , "dal" , "l" , "dl" , "cl" , "ml", "kL" , "hL" , "daL" , "L" , "dL" , "cL" , "mL" , "càc" , "cc" , "càs" , "cs");
		Collections.addAll(paramsTechniques,RecipeValidator.INGREDIENTS,RecipeValidator.UTENSIL,RecipeValidator.PREPARATION,RecipeValidator.TEMPERATURE,RecipeValidator.TOOL,RecipeValidator.QUANTITY,RecipeValidator.TIME);		
	}
	
	@Override
	public void completeModel_DefTechniques(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeModel_DefTechniques(model, assignment, context, acceptor);
		String proposal = "define nametechnique";
		acceptor.accept(createCompletionProposal(proposal, context));
	}
	
	public void completeModel_Recipes(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeModel_Recipes(model, assignment, context, acceptor);
		String proposal = "recipe {\n"
				+ "	name: name Recipe\n"
				+ "	time: 0min\n"
				+ "	nb_pers: 0\n"
				+ "	ingredients:{\n"
				+ "	}\n"
				+ "	ustensils:{\n"
				+ "	}\n"
				+ "	instructions: {\n"
				+ "	}\n"
				+ "}\n";
		acceptor.accept(createCompletionProposal(proposal, context));
	}
	
	public void completeTechnique_Name(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeTechnique_Name(model, assignment, context, acceptor);
	}
	
	public void completeTechnique_Param(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeTechnique_Param(model, assignment, context, acceptor);
		
		for(String proposal: paramsTechniques) {
			acceptor.accept(createCompletionProposal(proposal, context));
			acceptor.accept(createCompletionProposal("[" + proposal+ "]" , context));
		}
	}
	
	public void completeParamTechnique_ObjectFac(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeParamTechnique_ObjectFac(model, assignment, context, acceptor);
		for(String proposal: paramsTechniques) {
			acceptor.accept(createCompletionProposal(proposal, context));
		}
	}
	public void completeParamTechnique_Object(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeParamTechnique_Object(model, assignment, context, acceptor);
		for(String proposal: paramsTechniques) {
			acceptor.accept(createCompletionProposal(proposal, context));
			acceptor.accept(createCompletionProposal("[" + proposal+ "]" , context));
		}
	}
	
	public void completeRecipe_Time(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeRecipe_Time(model, assignment, context, acceptor);
		//each int value is converted as a string value to be one proposal for time
		IntStream
			.range(0, 10)
			.mapToObj(i -> String.valueOf(i))
			.forEach(i -> acceptor.accept(createCompletionProposal(i, context)));
	}
	
	public void completeRecipe_Nb(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeRecipe_Nb(model, assignment, context, acceptor);
		//each int value is converted as a string value to be one proposal for nb of personnes
		IntStream
			.range(0, 10)
			.mapToObj(i -> String.valueOf(i))
			.forEach(i -> acceptor.accept(createCompletionProposal(i, context)));
	}
	
	public void completeRecipe_Ingredients(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeRecipe_Ingredients(model, assignment, context, acceptor);
		String proposal = "ingredients:{\n"
				+ "	}\n";
		acceptor.accept(createCompletionProposal(proposal, context));

	}
	
	public void completeRecipe_Ustensils(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeRecipe_Utensils(model, assignment, context, acceptor);
		String proposal = "ustensils:{\n"
				+ "	}\n";
		acceptor.accept(createCompletionProposal(proposal, context));
	}
	public void completeRecipe_Instructions(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeRecipe_Instructions(model, assignment, context, acceptor);
		String proposal = "instructions: {\n"
				+ "	}\n";
		acceptor.accept(createCompletionProposal(proposal, context));
	}
	
	public void completeUtensilList_Uten(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeUtensilList_Uten(model, assignment, context, acceptor);
		String proposal = "name Utensil @name,";
		acceptor.accept(createCompletionProposal(proposal, context));
	}
	
	public void completeUtensil_Name(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeUtensil_Name(model, assignment, context, acceptor);
	}
	
	public void completeUtensil_Tag(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeUtensil_Tag(model, assignment, context, acceptor);
	}
	
	public void completeIngredientList_Ingr(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeIngredientList_Ingr(model, assignment, context, acceptor);
		String proposal = "name Ingredient : any #group @name,";
		acceptor.accept(createCompletionProposal(proposal, context));
	}
	
	public void completeIngredient_Name(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeIngredient_Name(model, assignment, context, acceptor);
	}
	
	public void completeIngredient_Qty(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeIngredient_Qty(model, assignment, context, acceptor);
		String proposal = "any";
		acceptor.accept(createCompletionProposal(proposal, context));
		//each int value is converted as a string value to be one proposal for val and literal values
		IntStream
			.range(0, 10)
			.mapToObj(i -> String.valueOf(i))
			.forEach(i -> acceptor.accept(createCompletionProposal(i, context)));
	}
	
	public void completeIngredient_Group(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeIngredient_Group(model, assignment, context, acceptor);
	}
	public void completeIngredient_Tag(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeIngredient_Tag(model, assignment, context, acceptor);
	}
	public void completeQuantity_Qt(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeQuantity_Qt(model, assignment, context, acceptor);
		//each int value is converted as a string value to be one proposal for val and literal values
		IntStream
			.range(0, 10)
			.mapToObj(i -> String.valueOf(i))
			.forEach(i -> acceptor.accept(createCompletionProposal(i, context)));
	}
	public void completeQuantity_Quantifier(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeQuantity_Quantifier(model, assignment, context, acceptor);
	}
	public void completeQuantifier_Mesure(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeQuantifier_Mesure(model, assignment, context, acceptor);
		Instruction i = EcoreUtil2.getContainerOfType(model, Instruction.class);
		if(i==null) {
			for(String proposal: paramsQuantificateur) {
				acceptor.accept(createCompletionProposal(proposal, context));
			}
		}
	}
	
	public void completeInstructionList_Inst(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstructionList_Inst(model, assignment, context, acceptor);
	}
	
	public void completeInstruction_Technique(EObject instruction, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstruction_Technique(instruction, assignment, context, acceptor);
		// Getting the root of the model
        EObject rootElement = EcoreUtil2.getRootContainer(instruction);
        // Getting all the instances of Technique in the model
        List<Technique> candidates = EcoreUtil2.getAllContentsOfType(rootElement, Technique.class);
		for(Technique t : candidates) {
			acceptor.accept(createCompletionProposal(t.getName(), context));
		}
	}
	
	public void completeInstruction_Parameters(EObject instruction, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstruction_Parameters(instruction, assignment, context, acceptor);
		canCompleteInt=false;
		// Getting the root of the model
        EObject rootElement = EcoreUtil2.getRootContainer(instruction);
        // Getting all the instances of Technique in the model
        List<Technique> candidates = EcoreUtil2.getAllContentsOfType(rootElement, Technique.class);
		Technique t = RecipeValidator.getTechniqueFromName(((Instruction) instruction).getTechnique(), candidates);
		if(t!=null) {
			boolean choices=false;
			boolean intProposal = false;
			List<String> value=new ArrayList<>();
			Recipe recipe = EcoreUtil2.getContainerOfType(instruction, Recipe.class);
			Instruction inst = (Instruction) instruction;
			Set<String> delimiter = new HashSet<>();
			ParamTechnique param = getParamTechniqueCorrespondingToCurrentParameter(t, value, recipe, inst, delimiter);
			if(value.contains(RecipeValidator.INGREDIENTS)) {
				Set<String> delimiterIngredient=new HashSet<>();
				if(value.get(value.size()-1).equals(RecipeValidator.INGREDIENTS)) {
					for(String v : delimiter) {
						delimiterIngredient.add(v);
					}
				}
				delimiterIngredient.add(",");
				for(Ingredient ing : recipe.getIngredients().getIngr()) {
					for(String d : delimiterIngredient) {
						acceptor.accept(createCompletionProposal(RecipeValidator.customStringToString(ing.getName())+d, context));
						if(ing.getTag()!=null) {
							acceptor.accept(createCompletionProposal("@"+ing.getTag()+d, context));
						}
						if(ing.getGroup()!=null) {
							acceptor.accept(createCompletionProposal("#"+ing.getGroup()+d, context));
						}
					}
					for(String preparation : RecipeValidator.getPreparationListFromRecipe(recipe)) {
						for(String d : delimiterIngredient) {
							acceptor.accept(createCompletionProposal(preparation+d, context));
						}
					}
				}
			}
			if(value.contains(RecipeValidator.UTENSIL) || value.contains(RecipeValidator.TOOL)) {
				Set<String> delimiterUstensil=new HashSet<>();
				if(value.get(value.size()-1).equals(RecipeValidator.UTENSIL)||value.get(value.size()-1).equals(RecipeValidator.TOOL)) {
					for(String v : delimiter) {
						delimiterUstensil.add(v);
					}
				}
				delimiterUstensil.add(",");
				for(Utensil u : recipe.getUtensils().getUten()) {
					for(String d : delimiterUstensil) {
						acceptor.accept(createCompletionProposal(RecipeValidator.customStringToString(u.getName())+d, context));
						if(u.getTag()!=null) {
							acceptor.accept(createCompletionProposal("@"+u.getTag() + d, context));
						}
					}
				}
			}
			if(value.contains(RecipeValidator.PREPARATION)) {
				Set<String> delimiterPreparation=new HashSet<>();
				if(value.get(value.size()-1).equals(RecipeValidator.PREPARATION)) {
					for(String v : delimiter) {
						delimiterPreparation.add(v);
					}
				}
				delimiterPreparation.add(",");
				for(String preparation : RecipeValidator.getPreparationListFromRecipe(recipe)) {
					for(String d : delimiterPreparation) {
						acceptor.accept(createCompletionProposal(preparation+d, context));
					}
				}
			}
			if(value.size()>1 && (value.get(1).equals(RecipeValidator.QUANTITY) || value.get(1).equals(RecipeValidator.TIME) || value.get(1).equals(RecipeValidator.TEMPERATURE))) {
				intProposal=true;
			} else if(value.size()==1) {
				if(value.get(0).equals(RecipeValidator.QUANTITY) || value.get(0).equals(RecipeValidator.TIME) || value.get(0).equals(RecipeValidator.TEMPERATURE)) {
					intProposal=true;
				}
			}
			if(intProposal) {
				//each int value is converted as a string value to be one proposal for RecipeValidator.QUANTITY, RecipeValidator.TIME and RecipeValidator.TEMPERATURE values
				IntStream
					.range(0, 10)
					.mapToObj(i -> String.valueOf(i))
					.forEach(i -> acceptor.accept(createCompletionProposal(i, context)));
				canCompleteInt=true;
			}
			if(value.size()>1 && value.get(1).equals(RecipeValidator.CHOICES)) {
				choices=true;
			} else {
				if(t.getParam().size()==1 && value.get(0).equals(RecipeValidator.CHOICES)) {
					choices=true;
				}
			}
			if(choices) {
				List<List<String>> combinaisons = new ArrayList<>();
				int index=0;
				for(Choice l : param.getChoices().getChoices()) {
					combinaisons.add(new ArrayList<>());
					for(String s : l.getChoice()) {
						combinaisons.get(index).add(s);
					}
					index++;
				}
				getCombinations(new ArrayList<String>(), 0, combinaisons, delimiter, context, acceptor);
				List<String> completions = new ArrayList<>();
				for(String c :param.getChoices().getChoice()) {
					completions.add(c);
				}
				for(String choice :completions) {
					for(String d : delimiter) {
						acceptor.accept(createCompletionProposal(choice+d, context));
					}
				} 
			}
		}
	}

	private ParamTechnique getParamTechniqueCorrespondingToCurrentParameter(Technique t, List<String> value,
			Recipe recipe, Instruction inst, Set<String> delimiter) {
		List<String> instructionParam = getListOFInstructionParameters(inst.getParameters(), recipe, t);
		ParamTechnique param=null;
		int size = instructionParam.size();
		int fin=size;
		for(int i = size-1; i<=fin; i++) {
			if(i>-1 && i<t.getParam().size()) {
				param = t.getParam().get(i);
				if(param.getObjectFac()!=null) {
					fin+=1;
				}
				addParamToValueList(value, param);
			}
		}
		if(fin>=t.getParam().size()-1) {
			delimiter.add(";\n");
			delimiter.add(" ");
		} else {
			delimiter.add(",");
		}
		return param;
	}
	
	public void getCombinations(List<String> soFar, int i, List<List<String>> lists, Set<String> delimiter, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
	    if (i == lists.size()) { //no more lists left:
	        //do work on soFar
	    	String str = "";
			for(String s : soFar) {
				str+=s.trim()+" ";
			}
			for(String d : delimiter) {
				acceptor.accept(createCompletionProposal(str+d, context));
			}
	    }
	    else { 
	        for (String t : lists.get(i)) {
	            soFar.add(t); //"guess' item
	            getCombinations(soFar, i+1, lists, delimiter, context, acceptor);
	            soFar.remove(soFar.size()-1); //cleanup
	        }
	    }
	}
	
	private void addParamToValueList(List<String> value, ParamTechnique param) {
		if(param.getObject()!=null) {
			value.add(param.getObject());
		} else if(param.getObjectFac()!=null) {
			value.add(param.getObjectFac());
		} else {
			value.add(RecipeValidator.CHOICES);
		}
	}
	
	public List<String> getListOFInstructionParameters(List<InstructionParameter> list, Recipe r, Technique t) {
		List<String> lParameters = new ArrayList<>();
		int size=0;
		for(InstructionParameter param : list) {
			String toAdd = "";
			if(param.getHtag()!=null) {
				if(lParameters.isEmpty() || !lParameters.get(lParameters.size()-1).equals(RecipeValidator.INGREDIENTS)) {
					toAdd=RecipeValidator.INGREDIENTS;	
				}
			} else if(param.getAtag()!=null) {
				EObject l = RecipeValidator.getIngredientOrUstensilFromATag(param.getAtag(), r);
				if(l instanceof Ingredient) {
					if(lParameters.isEmpty() || !lParameters.get(lParameters.size()-1).equals(RecipeValidator.INGREDIENTS)) {
						toAdd = RecipeValidator.INGREDIENTS;	
					}
				} else if(l instanceof Utensil) {
					if(lParameters.isEmpty() || !lParameters.get(lParameters.size()-1).equals(RecipeValidator.UTENSIL)) {
						toAdd = RecipeValidator.UTENSIL;	
					}
				}
			} else if(param.getParameter()!=null) {
				Object l = RecipeValidator.getIngredientOrUstensilOrPreparationFromName(param.getParameter(), r);
				if(l instanceof Ingredient) {
					if(lParameters.isEmpty() || !lParameters.get(lParameters.size()-1).equals(RecipeValidator.INGREDIENTS)) {
						toAdd = RecipeValidator.INGREDIENTS;	
					}
				} else if(l instanceof Utensil) {
					if(lParameters.isEmpty() || !lParameters.get(lParameters.size()-1).equals(RecipeValidator.UTENSIL)) {
						toAdd = RecipeValidator.UTENSIL;
					}
				} else if(l instanceof CustomString) {
					if(lParameters.isEmpty() || !lParameters.get(lParameters.size()-1).equals(RecipeValidator.PREPARATION)) {
						toAdd = RecipeValidator.PREPARATION;	
					}
				} else {
					lParameters.add(RecipeValidator.CHOICES);
					size++;
				}
			} else if(param.getQt()!=null) {
				lParameters.add(RecipeValidator.QUANTITY);
				size++;
			} else if(param.getTemp()!=null) {
				lParameters.add(RecipeValidator.TEMPERATURE);
				size++;
			}else if(param.getTime()!=null) {
				lParameters.add(RecipeValidator.TIME);
				size++;
			} 
			if(!toAdd.equals("")) {
				//check if we have an facultative object that not equal to current parameter 
				boolean fac=true;
				while(fac && size<t.getParam().size()) {
					String obligatory = t.getParam().get(size).getObject();
					String facult = t.getParam().get(size).getObjectFac();
					if(obligatory!=null && facult==null && toAdd.equals(obligatory)) {
						fac=false;
					} else if(obligatory==null && facult!=null && toAdd.equals(facult)) {
						fac=false;
					} else {
						lParameters.add(facult);
						size++;
					} 
				}
				if(size==0) {
					lParameters.add(toAdd);	
					size++;
				} else if(lParameters.get(size-1)!=toAdd) {
					lParameters.add(toAdd);
					size++;
				}
			}
		}
		return lParameters;
	}
	
	public void completeInstruction_Comment(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstruction_Comment(model, assignment, context, acceptor);
	}
	public void completeInstruction_Preparation(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstruction_Preparation(model, assignment, context, acceptor);
	}
	public void completeInstructionParameter_Parameter(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstructionParameter_Parameter(model, assignment, context, acceptor);
	}
	public void completeInstructionParameter_Htag(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstructionParameter_Htag(model, assignment, context, acceptor);
	}
	public void completeInstructionParameter_Atag(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstructionParameter_Atag(model, assignment, context, acceptor);
	}
	public void completeInstructionParameter_Qte(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstructionParameter_Qte(model, assignment, context, acceptor);
	}
	public void completeInstructionParameter_Qt(EObject instructionParam, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstructionParameter_Qt(instructionParam, assignment, context, acceptor);
		// Getting the root of the model
        EObject rootElement = EcoreUtil2.getRootContainer(instructionParam);
        // Getting all the instances of Technique in the model
        List<Technique> candidates = EcoreUtil2.getAllContentsOfType(rootElement, Technique.class);
        Instruction inst = EcoreUtil2.getContainerOfType(instructionParam, Instruction.class);
		Technique t = RecipeValidator.getTechniqueFromName(((Instruction) inst).getTechnique(), candidates);
		if(t!=null) {
			List<String> value=new ArrayList<>();
			Recipe recipe = EcoreUtil2.getContainerOfType(inst, Recipe.class);
			Set<String> delimiter = new HashSet<>();
			getParamTechniqueCorrespondingToCurrentParameter(t, value, recipe, inst, delimiter);
			boolean quantity=false;
			if(value.size()>1 && (value.get(1).equals(RecipeValidator.QUANTITY))) {
				quantity=true;
			} else {
				if(value.get(0).equals(RecipeValidator.QUANTITY)) {
					quantity=true;
				}
			}
			if(quantity) {
				for(String proposal : paramsQuantificateur) {
					for(String d : delimiter) {
						acceptor.accept(createCompletionProposal(proposal+d, context));
					}
				}
			}
		}
	}
	public void completeInstructionParameter_Time(EObject instructionParam, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstructionParameter_Time(instructionParam, assignment, context, acceptor);
		// Getting the root of the model
        EObject rootElement = EcoreUtil2.getRootContainer(instructionParam);
        // Getting all the instances of Technique in the model
        List<Technique> candidates = EcoreUtil2.getAllContentsOfType(rootElement, Technique.class);
        Instruction inst = EcoreUtil2.getContainerOfType(instructionParam, Instruction.class);
		Technique t = RecipeValidator.getTechniqueFromName(((Instruction) inst).getTechnique(), candidates);
		if(t!=null) {
			List<String> value=new ArrayList<>();
			Recipe recipe = EcoreUtil2.getContainerOfType(inst, Recipe.class);
			Set<String> delimiter = new HashSet<>();
			getParamTechniqueCorrespondingToCurrentParameter(t, value, recipe, inst, delimiter);
			boolean time=false;
			if(value.size()>1 && (value.get(1).equals(RecipeValidator.TIME))) {
				time=true;
			} else {
				if(value.get(0).equals(RecipeValidator.TIME)) {
					time=true;
				}
			}
			if(time) {
				for(String proposal : Arrays.asList("s" ,"min",  "h", "days")) {
					for(String d : delimiter) {
						acceptor.accept(createCompletionProposal(proposal+d, context));
					}
				}
			}
		}
	}
	public void completeTime_TimeUnit(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeTime_TimeUnit(model, assignment, context, acceptor);
		for(String proposal : Arrays.asList("s" ,"min",  "h", "days")) {
			acceptor.accept(createCompletionProposal(proposal, context));
		}
	}
	
	public void completeInstructionParameter_Temp(EObject instructionParam, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeInstructionParameter_Temp(instructionParam, assignment, context, acceptor);
		// Getting the root of the model
        EObject rootElement = EcoreUtil2.getRootContainer(instructionParam);
        // Getting all the instances of Technique in the model
        List<Technique> candidates = EcoreUtil2.getAllContentsOfType(rootElement, Technique.class);
        Instruction inst = EcoreUtil2.getContainerOfType(instructionParam, Instruction.class);
		Technique t = RecipeValidator.getTechniqueFromName(((Instruction) inst).getTechnique(), candidates);
		if(t!=null) {
			List<String> value=new ArrayList<>();
			Recipe recipe = EcoreUtil2.getContainerOfType(inst, Recipe.class);
			Set<String> delimiter = new HashSet<>();
			getParamTechniqueCorrespondingToCurrentParameter(t, value, recipe, inst, delimiter);
			boolean temperature=false;
			if(value.size()>1 && (value.get(1).equals(RecipeValidator.TEMPERATURE))) {
				temperature=true;
			} else {
				if(value.get(0).equals(RecipeValidator.TEMPERATURE)) {
					temperature=true;
				}
			}
			if(temperature) {
				for(String proposal : Arrays.asList("°C" ,"F")) {
					for(String d : delimiter) {
						acceptor.accept(createCompletionProposal(proposal+d, context));
					}
				}
			}
		}
	}
	public void completeCustomString_Name(EObject model, Assignment assignment, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		super.completeCustomString_Name(model, assignment, context, acceptor);
	}
	
	public void complete_Model(Model model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
	}
	
	public void complete_Technique(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_ParamTechnique(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		
	}
	public void complete_Choices(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_IngrUslTech(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	
	public void complete_Recipe(Recipe recipe, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
	}
	
	public void complete_Ustensils(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_Ustensil(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_Ingredients(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_Ingredient(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_Quantite(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_Quantificateurs(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_Mesure(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_Instructions(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_Instruction(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_Timing(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_Temp(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_InstructionParameter(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_CustomString(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_DOUBLE(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_WORD(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
	public void complete_COMMENT(EObject model, RuleCall ruleCall, ContentAssistContext context, ICompletionProposalAcceptor acceptor) {
		// subclasses may override
	}
}
